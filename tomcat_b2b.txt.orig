vmware  user: sapuser

======================= Notes=======================

=========================Web prj============================

web.xml -> env-entry for sys.global.dir

Can ignore(it does that no matter what): WARN  com.sap.isa.core.eai.sp.jco.JCoConnectionStateless [] - Error occcurred in EAI layer "Cannot connect to backend system. com.sap.isa.core.eai.BackendException: user missing. parameters: [client]='null' [user]='null' [language]='null' [ashost]='null' [systemnumber]='null' [mshost]='null' [gwhost]='null' [gwserv]='null' [group]='null' [systemid]='null' 
Properties: {client=100, sysnr=01, ashost=bighorn.pcf.com, lang=en, codepage=1100}


The value for the useBean class attribute com.sap.isa.businessobject.marketing.MktQuestionary is invalid.org.apache.jasper.JasperException: /b2c/pcf/newregister.jsp(244,4) The value for the useBean class attribute com.sap.isa.businessobject.marketing.MktQuestionary is invalid
-> http://www.manning-sandbox.com/thread.jspa?forumID=35&threadID=10121&messageID=29899#29899
-> http://www.mularien.com/blog/2008/02/19/tutorial-how-to-set-up-tomcat-6-to-work-with-jstl-12/
for use-bean tahs replace "class=" by "type=" in all jsp's (works on sap engine as well)

Java patches

+ sisu

============== PCF env ===================
tomcat: regular deploy in Netbeans   http://local-sealy/
SAp engine(vmware) build apps_b2c_sealy / dist  then deploy with visualadmin: 192.168.21.132 50104

sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/local-sealy-sap.pem
.. # nevermind http://www.g-loaded.eu/2007/08/10/ssl-enabled-name-based-apache-virtual-hosts-with-mod_gnutls/

http://en.gentoo-wiki.com/wiki/Apache2/SSL_and_Name_Based_Virtual_Hosts

use wget -S to test

======================= proxy ===============
#Listen 443

##### 443 HTTPS #######
NameVirtualHost 127.0.0.1:443

#B2B Sap
<VirtualHost 127.0.0.1:443>
ServerName local-b2b-sap:443
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120

SSLEngine on
SSLProxyEngine on
SSLCertificateFile /etc/apache2/ssl/local-b2b-sap.pem
SSLCertificateKeyFile /etc/apache2/ssl/local-b2b-sap.pem

ProxyPassReverse / https://localsap:50101/
RewriteRule ^/staticcontent/(.*) https://bgprxdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^[/]?$ https://localsap:50101/b2b_global/b2b/init.do [P]
RewriteRule ^/b2b_global/admin$ /b2b_global/b2b/init.do [R]
RewriteRule ^/b2b_global/(.*) https://localsap:50101/b2b_global/$1 [P]
RewriteCond %{REQUEST_METHOD} GET
RewriteRule ^/cimg/(.*) https://crmimagesdev.pcf.com/$1 [P]
</VirtualHost>

#B2C Sealy Sap
<VirtualHost 127.0.0.1:443>
ServerName local-sealy-sap:443
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120

SSLEngine on
SSLProxyEngine on
SSLCertificateFile /etc/apache2/ssl/local-sealy-sap.pem
SSLCertificateKeyFile /etc/apache2/ssl/local-sealy-sap.pem

ProxyPassReverse / https://localsap:50101/
RewriteRule ^[/]?$ https://localsap:50101/b2c_sealy/link.do?link=ZHOMESTD [P]
RewriteRule ^/b2c_sealy/(.*) https://localsap:50101/b2c_sealy/$1 [P]
RewriteRule ^/staticcontent/(.*) https://cprxdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^/cimg/(.*) https://crmimg.pcf.com/$1 [P]
RewriteRule ^/(.*) https://localsap:50101/b2c_sealy/link.do?link=$1&%{QUERY_STRING} [P]
</VirtualHost>

#B2C PCoast Sap
<VirtualHost local-pcoast-sap:443>
ServerName local-pcoast-sap:443
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120

SSLEngine on
SSLProxyEngine on
SSLCertificateFile /etc/apache2/ssl/local-pcoast-sap.pem
SSLCertificateKeyFile /etc/apache2/ssl/local-pcoast-sap.pem

ProxyPassReverse / https://localsap:50101/
RewriteRule ^[/]?$ https://localsap:50101/b2c_pcoast/link.do?link=ZHOMESTD [P]
RewriteRule ^/staticcontent/(.*) https://pcoastdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^/b2c_pcoast/(.*) https://localsap:50101/b2c_pcoast/$1 [P]
RewriteRule ^/cimg/(.*) https://crmimagesdev.pcf.com/$1 [P]
RewriteRule ^(.*) https://localsap:50101/b2c_pcoast/link.do?link=$1&%{QUERY_STRING} [P]
</VirtualHost>

###### 80 HTTP ###########
NameVirtualHost 127.0.0.1:80

# b2b tomcat
<VirtualHost local-b2b:80>
ServerName local-b2b:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^[/]?$ http://localhost:8080/b2b_global/b2b/init.do [P]
RewriteRule ^/staticcontent/(.*) http://bgprxdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^/cimg/(.*) http://crmimagesdev.pcf.com/$1 [P]
RewriteRule ^(.*) http://localhost:8080/$1 [P]
</VirtualHost>

# sealy tomcat
<VirtualHost local-sealy:80>
ServerName local-sealy:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^[/]?$ http://localhost:8080/b2c_dev/link.do?link=ZHOMESTD [P]
RewriteRule ^/b2c_sealy/(.*) http://localhost:8080/b2c_dev/$1 [P]
RewriteRule ^/b2c_dev/(.*) http://localhost:8080/b2c_dev/$1 [P]
RewriteRule ^/staticcontent/(.*) http://cprxdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^/cimg/(.*) http://crmimg.pcf.com/$1 [P]
RewriteRule ^/(.*) http://localhost:8080/b2c_dev/link.do?link=$1&%{QUERY_STRING} [P]
</VirtualHost>

# pcoast tomcat
<VirtualHost local-pcoast:80>
ServerName local-pcoast:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^[/]?$ http://localhost:8080/b2c_dev/link.do?link=ZHOMESTD [P]
RewriteRule ^/b2c_pcoast/(.*) http://localhost:8080/b2c_dev/$1 [P]
RewriteRule ^/b2c_dev/(.*) http://localhost:8080/b2c_dev/$1 [P]
RewriteRule ^/staticcontent/(.*) http://pcoastdev.pcf.com/staticcontent/$1 [L]
RewriteRule ^/cimg/(.*) http://crmimagesdev.pcf.com/$1 [P]
RewriteRule ^(.*) http://localhost:8080/b2c_dev/link.do?link=$1&%{QUERY_STRING} [P]
</VirtualHost>

### Redirect SAP engine sites to use https only (to avoid http to https cart swicth issues ###
<VirtualHost local-sealy-sap:80>
ServerName local-sealy-sap:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^/(.*) https://local-sealy-sap/$1 [R,L]
</VirtualHost>

<VirtualHost local-pcoast-sap:80>
ServerName local-pcoast-sap:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^/(.*) https://local-pcoast-sap/$1 [R,L]
</VirtualHost>

<VirtualHost local-b2b-sap:80>
ServerName local-b2b-sap:80
DocumentRoot /var/www/
RewriteEngine On
RewriteLog "/var/log/apache2/sap.rewrite.log"
RewriteLogLevel 5
TimeOut 120
ProxyPassReverse / http://localhost:8080/
RewriteRule ^/(.*) https://local-b2b-sap/$1 [R,L]
</VirtualHost>

